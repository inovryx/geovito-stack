{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://geovito.com/contracts/atlas-import.v1.schema.json",
  "title": "Geovito Atlas Import Contract v1",
  "type": "object",
  "additionalProperties": false,
  "required": ["contract_version", "batch", "places"],
  "properties": {
    "contract_version": {
      "type": "string",
      "const": "atlas-import.v1"
    },
    "batch": {
      "type": "object",
      "additionalProperties": false,
      "required": ["batch_id", "idempotency_key", "source", "created_at"],
      "properties": {
        "batch_id": {
          "type": "string",
          "minLength": 3
        },
        "idempotency_key": {
          "type": "string",
          "minLength": 3
        },
        "source": {
          "type": "string",
          "minLength": 2
        },
        "created_at": {
          "type": "string",
          "format": "date-time"
        },
        "dry_run": {
          "type": "boolean"
        }
      }
    },
    "places": {
      "type": "array",
      "minItems": 1,
      "items": {
        "$ref": "#/$defs/placeRecord"
      }
    }
  },
  "$defs": {
    "localizedEntry": {
      "type": "object",
      "additionalProperties": false,
      "required": ["status"],
      "properties": {
        "status": {
          "type": "string",
          "enum": ["missing", "draft", "complete"]
        },
        "title": {
          "type": "string"
        },
        "slug": {
          "type": "string"
        },
        "excerpt": {
          "type": "string"
        },
        "body": {
          "type": "string"
        }
      }
    },
    "translations": {
      "type": "object",
      "additionalProperties": false,
      "properties": {
        "en": {
          "$ref": "#/$defs/localizedEntry"
        },
        "tr": {
          "$ref": "#/$defs/localizedEntry"
        },
        "de": {
          "$ref": "#/$defs/localizedEntry"
        },
        "es": {
          "$ref": "#/$defs/localizedEntry"
        },
        "ru": {
          "$ref": "#/$defs/localizedEntry"
        },
        "zh-cn": {
          "$ref": "#/$defs/localizedEntry"
        }
      }
    },
    "placeRecord": {
      "type": "object",
      "additionalProperties": false,
      "required": [
        "place_id",
        "place_type",
        "country_code",
        "canonical_language",
        "import_payload_version",
        "import_checksum",
        "translations"
      ],
      "properties": {
        "place_id": {
          "type": "string",
          "minLength": 3
        },
        "place_type": {
          "type": "string",
          "enum": [
            "country",
            "admin1",
            "admin2",
            "admin3",
            "locality",
            "neighborhood",
            "street",
            "poi",
            "admin_area",
            "city",
            "district"
          ]
        },
        "country_code": {
          "type": "string",
          "minLength": 2,
          "maxLength": 2
        },
        "parent_place_id": {
          "type": ["string", "null"]
        },
        "admin_level": {
          "type": ["integer", "null"],
          "minimum": 0,
          "maximum": 12
        },
        "coordinates": {
          "type": ["object", "null"],
          "additionalProperties": false,
          "required": ["latitude", "longitude"],
          "properties": {
            "latitude": {
              "type": "number"
            },
            "longitude": {
              "type": "number"
            }
          }
        },
        "canonical_language": {
          "type": "string",
          "enum": ["en", "tr", "de", "es", "ru", "zh-cn"]
        },
        "import_payload_version": {
          "type": "string"
        },
        "import_checksum": {
          "type": "string"
        },
        "translations": {
          "$ref": "#/$defs/translations"
        },
        "raw": {
          "type": ["object", "null"]
        }
      }
    }
  }
}
